17:01:26 - INFO - ======================================================================
17:01:26 - INFO - RUN TYPE: PREPROCESSING
17:01:26 - INFO - DATASET: clothing
17:01:26 - INFO - TIMESTAMP: 20251218_170126
17:01:26 - INFO - LOG DIR: logs\preprocessing\clothing_20251218_170126
17:01:26 - INFO - ======================================================================
17:01:26 - INFO - System Information:
17:01:26 - INFO -   platform: Windows-11-10.0.26200-SP0
17:01:26 - INFO -   python_version: 3.12.8
17:01:26 - INFO -   cpu_count: 20
17:01:26 - INFO -   ram_total_gb: 63.77
17:01:26 - INFO -   ram_available_gb: 49.61
17:01:26 - INFO -   gpu_name: NVIDIA GeForce RTX 3060
17:01:26 - INFO -   gpu_memory_gb: 12.00
17:01:26 - INFO -   cuda_version: 12.8
17:01:26 - INFO - Configuration:
17:01:26 - INFO -   clip_model: openai/clip-vit-large-patch14
17:01:26 - INFO -   cold_item_ratio: 0.2
17:01:26 - INFO -   dataset: clothing
17:01:26 - INFO -   k_core: 5
17:01:26 - INFO -   max_total_nodes: 20000
17:01:26 - INFO -   min_total_nodes: 12500
17:01:26 - INFO -   sbert_model: sentence-transformers/all-mpnet-base-v2
17:01:26 - INFO -   seed: 42
17:01:26 - INFO -   seed_users: 10000
17:01:26 - INFO -   test_warm_ratio: 0.1
17:01:26 - INFO -   text_columns: ['title', 'description', 'features']
17:01:26 - INFO -   train_ratio: 0.8
17:01:26 - INFO -   val_ratio: 0.1
17:01:26 - INFO - 
17:01:26 - INFO - Output directory: data\processed\clothing
17:01:26 - INFO - 
17:01:26 - INFO - ============================================================
17:01:26 - INFO - Starting Inductive Preprocessing Pipeline
17:01:26 - INFO - ============================================================
17:01:26 - INFO - Loading interactions from data\raw\Clothing_Shoes_and_Jewelry.csv
17:01:39 - INFO - Loaded 23,102,537 interactions, 2,524,981 users, 714,957 items
17:01:42 - INFO - Memory usage: 3084.5 MB
17:01:42 - INFO - Attempt 1: Sampling 10,000 seed users...
17:01:44 - INFO - Applying recursive 5-core filtering...
17:01:44 - INFO - K-core converged after 4 iterations
17:01:44 - INFO - K-core: 91,646 → 0 interactions (0.0%)
17:01:44 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:44 - WARNING - Graph too small (0 < 12500). Increasing seed: 10,000 → 12,000
17:01:44 - INFO - Attempt 2: Sampling 12,000 seed users...
17:01:47 - INFO - Applying recursive 5-core filtering...
17:01:47 - INFO - K-core converged after 4 iterations
17:01:47 - INFO - K-core: 109,546 → 0 interactions (0.0%)
17:01:47 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:47 - WARNING - Graph too small (0 < 12500). Increasing seed: 12,000 → 14,400
17:01:47 - INFO - Attempt 3: Sampling 14,400 seed users...
17:01:49 - INFO - Applying recursive 5-core filtering...
17:01:49 - INFO - K-core converged after 4 iterations
17:01:49 - INFO - K-core: 131,376 → 0 interactions (0.0%)
17:01:49 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:49 - WARNING - Graph too small (0 < 12500). Increasing seed: 14,400 → 17,280
17:01:49 - INFO - Attempt 4: Sampling 17,280 seed users...
17:01:51 - INFO - Applying recursive 5-core filtering...
17:01:51 - INFO - K-core converged after 5 iterations
17:01:51 - INFO - K-core: 158,460 → 0 interactions (0.0%)
17:01:51 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:51 - WARNING - Graph too small (0 < 12500). Increasing seed: 17,280 → 20,736
17:01:51 - INFO - Attempt 5: Sampling 20,736 seed users...
17:01:53 - INFO - Applying recursive 5-core filtering...
17:01:53 - INFO - K-core converged after 5 iterations
17:01:53 - INFO - K-core: 189,558 → 0 interactions (0.0%)
17:01:53 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:53 - WARNING - Graph too small (0 < 12500). Increasing seed: 20,736 → 24,883
17:01:53 - INFO - Attempt 6: Sampling 24,883 seed users...
17:01:56 - INFO - Applying recursive 5-core filtering...
17:01:56 - INFO - K-core converged after 6 iterations
17:01:56 - INFO - K-core: 227,581 → 0 interactions (0.0%)
17:01:56 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:56 - WARNING - Graph too small (0 < 12500). Increasing seed: 24,883 → 29,859
17:01:56 - INFO - Attempt 7: Sampling 29,859 seed users...
17:01:58 - INFO - Applying recursive 5-core filtering...
17:01:58 - INFO - K-core converged after 7 iterations
17:01:58 - INFO - K-core: 271,449 → 0 interactions (0.0%)
17:01:58 - INFO - Result: 0 users + 0 items = 0 total nodes
17:01:58 - WARNING - Graph too small (0 < 12500). Increasing seed: 29,859 → 35,830
17:01:58 - INFO - Attempt 8: Sampling 35,830 seed users...
17:02:00 - INFO - Applying recursive 5-core filtering...
17:02:00 - INFO - K-core converged after 8 iterations
17:02:00 - INFO - K-core: 327,028 → 0 interactions (0.0%)
17:02:00 - INFO - Result: 0 users + 0 items = 0 total nodes
17:02:00 - WARNING - Graph too small (0 < 12500). Increasing seed: 35,830 → 42,996
17:02:00 - INFO - Attempt 9: Sampling 42,996 seed users...
17:02:03 - INFO - Applying recursive 5-core filtering...
17:02:03 - INFO - K-core converged after 13 iterations
17:02:03 - INFO - K-core: 393,955 → 0 interactions (0.0%)
17:02:03 - INFO - Result: 0 users + 0 items = 0 total nodes
17:02:03 - WARNING - Graph too small (0 < 12500). Increasing seed: 42,996 → 51,595
17:02:03 - INFO - Attempt 10: Sampling 51,595 seed users...
17:02:05 - INFO - Applying recursive 5-core filtering...
17:02:06 - INFO - K-core converged after 73 iterations
17:02:06 - INFO - K-core: 469,360 → 17,034 interactions (3.6%)
17:02:06 - INFO - Result: 2,596 users + 1,982 items = 4,578 total nodes
17:02:06 - WARNING - Graph too small (4578 < 12500). Increasing seed: 51,595 → 61,914
17:02:06 - INFO - Attempt 11: Sampling 61,914 seed users...
17:02:08 - INFO - Applying recursive 5-core filtering...
17:02:09 - INFO - K-core converged after 20 iterations
17:02:09 - INFO - K-core: 567,328 → 64,541 interactions (11.4%)
17:02:09 - INFO - Result: 8,988 users + 6,526 items = 15,514 total nodes
17:02:09 - INFO - ✓ Graph size 15,514 within target range [12500, 20000]
17:02:09 - INFO - Item split: 5,221 warm (80%), 1,305 cold (20%)
17:02:09 - INFO - Created ID mappings: 8,988 users, 5,221 warm items, 1,305 cold items
17:02:09 - INFO - Saved maps.json
17:02:09 - INFO - Warm interactions: 51,409, Cold interactions: 13,132
17:02:10 - INFO - Saved 41,127 interactions to train.txt
17:02:10 - INFO - Saved 5,141 interactions to val.txt
17:02:10 - INFO - Saved 5,141 interactions to test_warm.txt
17:02:10 - INFO - Saved 13,132 interactions to test_cold.txt
17:02:10 - INFO - ✓ Verified: max train item (5220) < n_warm (5221)
17:02:10 - INFO - Loading metadata for 6,526 items from data\raw\meta_Clothing_Shoes_and_Jewelry.jsonl.gz
17:02:10 - INFO - Using uncompressed metadata: data\raw\meta_Clothing_Shoes_and_Jewelry.jsonl
17:02:11 - INFO - Processed 100,000 lines, found 3,157 items...
17:02:12 - INFO - Processed 200,000 lines, found 4,355 items...
17:02:13 - INFO - Processed 300,000 lines, found 4,958 items...
17:02:14 - INFO - Processed 400,000 lines, found 5,307 items...
17:02:14 - INFO - Processed 500,000 lines, found 5,548 items...
17:02:15 - INFO - Processed 600,000 lines, found 5,710 items...
17:02:16 - INFO - Processed 700,000 lines, found 5,829 items...
17:02:17 - INFO - Processed 800,000 lines, found 5,924 items...
17:02:18 - INFO - Processed 900,000 lines, found 6,002 items...
17:02:19 - INFO - Processed 1,000,000 lines, found 6,057 items...
17:02:20 - INFO - Processed 1,100,000 lines, found 6,095 items...
17:02:21 - INFO - Processed 1,200,000 lines, found 6,135 items...
17:02:21 - INFO - Processed 1,300,000 lines, found 6,176 items...
17:02:22 - INFO - Processed 1,400,000 lines, found 6,216 items...
17:02:23 - INFO - Processed 1,500,000 lines, found 6,238 items...
17:02:24 - INFO - Processed 1,600,000 lines, found 6,262 items...
17:02:25 - INFO - Processed 1,700,000 lines, found 6,277 items...
17:02:26 - INFO - Processed 1,800,000 lines, found 6,290 items...
17:02:26 - INFO - Processed 1,900,000 lines, found 6,298 items...
17:02:27 - INFO - Processed 2,000,000 lines, found 6,309 items...
17:02:28 - INFO - Processed 2,100,000 lines, found 6,316 items...
17:02:29 - INFO - Processed 2,200,000 lines, found 6,326 items...
17:02:30 - INFO - Processed 2,300,000 lines, found 6,330 items...
17:02:31 - INFO - Processed 2,400,000 lines, found 6,338 items...
17:02:31 - INFO - Processed 2,500,000 lines, found 6,348 items...
17:02:32 - INFO - Processed 2,600,000 lines, found 6,356 items...
17:02:33 - INFO - Processed 2,700,000 lines, found 6,357 items...
17:02:34 - INFO - Processed 2,800,000 lines, found 6,367 items...
17:02:35 - INFO - Processed 2,900,000 lines, found 6,375 items...
17:02:35 - INFO - Processed 3,000,000 lines, found 6,381 items...
17:02:36 - INFO - Processed 3,100,000 lines, found 6,387 items...
17:02:37 - INFO - Processed 3,200,000 lines, found 6,395 items...
17:02:38 - INFO - Processed 3,300,000 lines, found 6,428 items...
17:02:39 - INFO - Processed 3,400,000 lines, found 6,447 items...
17:02:40 - INFO - Processed 3,500,000 lines, found 6,452 items...
17:02:40 - INFO - Processed 3,600,000 lines, found 6,458 items...
17:02:41 - INFO - Processed 3,700,000 lines, found 6,462 items...
17:02:42 - INFO - Processed 3,800,000 lines, found 6,468 items...
17:02:43 - INFO - Processed 3,900,000 lines, found 6,470 items...
17:02:44 - INFO - Processed 4,000,000 lines, found 6,471 items...
17:02:44 - INFO - Processed 4,100,000 lines, found 6,473 items...
17:02:45 - INFO - Processed 4,200,000 lines, found 6,476 items...
17:02:46 - INFO - Processed 4,300,000 lines, found 6,478 items...
17:02:47 - INFO - Processed 4,400,000 lines, found 6,482 items...
17:02:48 - INFO - Processed 4,500,000 lines, found 6,486 items...
17:02:48 - INFO - Processed 4,600,000 lines, found 6,487 items...
17:02:49 - INFO - Processed 4,700,000 lines, found 6,489 items...
17:02:50 - INFO - Processed 4,800,000 lines, found 6,490 items...
17:02:51 - INFO - Processed 4,900,000 lines, found 6,492 items...
17:02:52 - INFO - Processed 5,000,000 lines, found 6,496 items...
17:02:53 - INFO - Processed 5,100,000 lines, found 6,503 items...
17:02:53 - INFO - Processed 5,200,000 lines, found 6,511 items...
17:02:54 - INFO - Processed 5,300,000 lines, found 6,513 items...
17:02:55 - INFO - Processed 5,400,000 lines, found 6,515 items...
17:02:56 - INFO - Processed 5,500,000 lines, found 6,518 items...
17:02:56 - INFO - Processed 5,600,000 lines, found 6,521 items...
17:02:57 - INFO - Processed 5,700,000 lines, found 6,523 items...
17:02:58 - INFO - Processed 5,800,000 lines, found 6,524 items...
17:02:59 - INFO - Processed 5,900,000 lines, found 6,525 items...
17:03:00 - INFO - Processed 6,000,000 lines, found 6,525 items...
17:03:00 - INFO - Processed 6,100,000 lines, found 6,525 items...
17:03:01 - INFO - Processed 6,200,000 lines, found 6,525 items...
17:03:02 - INFO - Processed 6,300,000 lines, found 6,525 items...
17:03:03 - INFO - Processed 6,400,000 lines, found 6,525 items...
17:03:04 - INFO - Processed 6,500,000 lines, found 6,525 items...
17:03:04 - INFO - Processed 6,600,000 lines, found 6,525 items...
17:03:05 - INFO - Processed 6,700,000 lines, found 6,525 items...
17:03:06 - INFO - Processed 6,800,000 lines, found 6,525 items...
17:03:07 - INFO - Processed 6,900,000 lines, found 6,525 items...
17:03:07 - INFO - Processed 7,000,000 lines, found 6,525 items...
17:03:08 - INFO - Processed 7,100,000 lines, found 6,525 items...
17:03:08 - INFO - Loaded metadata for 6,526/6,526 items
17:03:11 - INFO - Extracting features on device: cuda
17:03:11 - INFO - Loading SBERT model: sentence-transformers/all-mpnet-base-v2
17:03:11 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
17:03:15 - INFO - Encoding 6,526 texts with SBERT (batch_size=128)...
17:03:59 - INFO - Saved text features: (6526, 768)
17:03:59 - INFO - Loading CLIP model: openai/clip-vit-large-patch14
17:04:03 - INFO - Extracting visual features for 6,526 items...
17:04:03 - INFO -   Batch size: 128, Download workers: 14
17:04:50 - INFO - Progress: 640/6526 (639 ok, 1 fail) | 13.7 items/s | ETA: 429s
17:05:34 - INFO - Progress: 1280/6526 (1279 ok, 1 fail) | 14.1 items/s | ETA: 372s
17:06:19 - INFO - Progress: 1920/6526 (1919 ok, 1 fail) | 14.1 items/s | ETA: 327s
17:07:02 - INFO - Progress: 2560/6526 (2559 ok, 1 fail) | 14.3 items/s | ETA: 278s
17:07:51 - INFO - Progress: 3200/6526 (3199 ok, 1 fail) | 14.1 items/s | ETA: 237s
17:08:40 - INFO - Progress: 3840/6526 (3838 ok, 2 fail) | 13.9 items/s | ETA: 193s
17:09:26 - INFO - Progress: 4480/6526 (4478 ok, 2 fail) | 13.9 items/s | ETA: 147s
17:10:14 - INFO - Progress: 5120/6526 (5118 ok, 2 fail) | 13.8 items/s | ETA: 102s
17:11:05 - INFO - Progress: 5760/6526 (5758 ok, 2 fail) | 13.7 items/s | ETA: 56s
17:11:59 - INFO - Progress: 6400/6526 (6398 ok, 2 fail) | 13.5 items/s | ETA: 9s
17:12:09 - INFO - Progress: 6526/6526 (6524 ok, 2 fail) | 13.4 items/s | ETA: 0s
17:12:09 - INFO - Visual extraction complete: 6,524 successful, 2 failed in 485.6s (13.4 items/s)
17:12:09 - INFO - Saved visual features: (6526, 768)
17:12:09 - INFO - Saved statistics to stat.txt
17:12:09 - INFO - ============================================================
17:12:09 - INFO - Preprocessing Complete!
17:12:09 - INFO - Output directory: data\processed\clothing
17:12:09 - INFO - ============================================================
17:12:09 - INFO - Log copied to: data\processed\clothing\preprocessing.log
17:12:09 - INFO - ======================================================================
17:12:09 - INFO - PREPROCESSING COMPLETE
17:12:09 - INFO - ======================================================================
