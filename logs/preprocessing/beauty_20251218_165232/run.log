16:52:32 - INFO - ======================================================================
16:52:32 - INFO - RUN TYPE: PREPROCESSING
16:52:32 - INFO - DATASET: beauty
16:52:32 - INFO - TIMESTAMP: 20251218_165232
16:52:32 - INFO - LOG DIR: logs\preprocessing\beauty_20251218_165232
16:52:32 - INFO - ======================================================================
16:52:32 - INFO - System Information:
16:52:32 - INFO -   platform: Windows-11-10.0.26200-SP0
16:52:32 - INFO -   python_version: 3.12.8
16:52:32 - INFO -   cpu_count: 20
16:52:32 - INFO -   ram_total_gb: 63.77
16:52:32 - INFO -   ram_available_gb: 49.56
16:52:32 - INFO -   gpu_name: NVIDIA GeForce RTX 3060
16:52:32 - INFO -   gpu_memory_gb: 12.00
16:52:32 - INFO -   cuda_version: 12.8
16:52:32 - INFO - Configuration:
16:52:32 - INFO -   clip_model: openai/clip-vit-large-patch14
16:52:32 - INFO -   cold_item_ratio: 0.2
16:52:32 - INFO -   dataset: beauty
16:52:32 - INFO -   k_core: 5
16:52:32 - INFO -   max_total_nodes: 20000
16:52:32 - INFO -   min_total_nodes: 12500
16:52:32 - INFO -   sbert_model: sentence-transformers/all-mpnet-base-v2
16:52:32 - INFO -   seed: 42
16:52:32 - INFO -   seed_users: 10000
16:52:32 - INFO -   test_warm_ratio: 0.1
16:52:32 - INFO -   text_columns: ['title', 'description', 'features']
16:52:32 - INFO -   train_ratio: 0.8
16:52:32 - INFO -   val_ratio: 0.1
16:52:32 - INFO - 
16:52:32 - INFO - Output directory: data\processed\beauty
16:52:32 - INFO - 
16:52:32 - INFO - ============================================================
16:52:32 - INFO - Starting Inductive Preprocessing Pipeline
16:52:32 - INFO - ============================================================
16:52:32 - INFO - Loading interactions from data\raw\Beauty_and_Personal_Care.csv
16:52:35 - INFO - Loaded 6,624,441 interactions, 729,576 users, 207,649 items
16:52:36 - INFO - Memory usage: 884.5 MB
16:52:36 - INFO - Attempt 1: Sampling 10,000 seed users...
16:52:37 - INFO - Applying recursive 5-core filtering...
16:52:37 - INFO - K-core converged after 6 iterations
16:52:37 - INFO - K-core: 90,997 → 0 interactions (0.0%)
16:52:37 - INFO - Result: 0 users + 0 items = 0 total nodes
16:52:37 - WARNING - Graph too small (0 < 12500). Increasing seed: 10,000 → 12,000
16:52:37 - INFO - Attempt 2: Sampling 12,000 seed users...
16:52:37 - INFO - Applying recursive 5-core filtering...
16:52:37 - INFO - K-core converged after 7 iterations
16:52:37 - INFO - K-core: 106,999 → 0 interactions (0.0%)
16:52:37 - INFO - Result: 0 users + 0 items = 0 total nodes
16:52:37 - WARNING - Graph too small (0 < 12500). Increasing seed: 12,000 → 14,400
16:52:37 - INFO - Attempt 3: Sampling 14,400 seed users...
16:52:38 - INFO - Applying recursive 5-core filtering...
16:52:38 - INFO - K-core converged after 9 iterations
16:52:38 - INFO - K-core: 132,512 → 0 interactions (0.0%)
16:52:38 - INFO - Result: 0 users + 0 items = 0 total nodes
16:52:38 - WARNING - Graph too small (0 < 12500). Increasing seed: 14,400 → 17,280
16:52:38 - INFO - Attempt 4: Sampling 17,280 seed users...
16:52:38 - INFO - Applying recursive 5-core filtering...
16:52:38 - INFO - K-core converged after 14 iterations
16:52:38 - INFO - K-core: 157,180 → 0 interactions (0.0%)
16:52:38 - INFO - Result: 0 users + 0 items = 0 total nodes
16:52:38 - WARNING - Graph too small (0 < 12500). Increasing seed: 17,280 → 20,736
16:52:38 - INFO - Attempt 5: Sampling 20,736 seed users...
16:52:39 - INFO - Applying recursive 5-core filtering...
16:52:39 - INFO - K-core converged after 35 iterations
16:52:39 - INFO - K-core: 187,209 → 4,363 interactions (2.3%)
16:52:39 - INFO - Result: 642 users + 514 items = 1,156 total nodes
16:52:39 - WARNING - Graph too small (1156 < 12500). Increasing seed: 20,736 → 24,883
16:52:39 - INFO - Attempt 6: Sampling 24,883 seed users...
16:52:39 - INFO - Applying recursive 5-core filtering...
16:52:40 - INFO - K-core converged after 21 iterations
16:52:40 - INFO - K-core: 225,610 → 21,528 interactions (9.5%)
16:52:40 - INFO - Result: 3,014 users + 2,224 items = 5,238 total nodes
16:52:40 - WARNING - Graph too small (5238 < 12500). Increasing seed: 24,883 → 29,859
16:52:40 - INFO - Attempt 7: Sampling 29,859 seed users...
16:52:40 - INFO - Applying recursive 5-core filtering...
16:52:40 - INFO - K-core converged after 13 iterations
16:52:40 - INFO - K-core: 273,413 → 40,724 interactions (14.9%)
16:52:40 - INFO - Result: 5,422 users + 3,876 items = 9,298 total nodes
16:52:40 - WARNING - Graph too small (9298 < 12500). Increasing seed: 29,859 → 35,830
16:52:40 - INFO - Attempt 8: Sampling 35,830 seed users...
16:52:41 - INFO - Applying recursive 5-core filtering...
16:52:41 - INFO - K-core converged after 11 iterations
16:52:41 - INFO - K-core: 331,409 → 67,801 interactions (20.5%)
16:52:41 - INFO - Result: 8,840 users + 6,194 items = 15,034 total nodes
16:52:41 - INFO - ✓ Graph size 15,034 within target range [12500, 20000]
16:52:41 - INFO - Item split: 4,956 warm (80%), 1,238 cold (20%)
16:52:41 - INFO - Created ID mappings: 8,840 users, 4,956 warm items, 1,238 cold items
16:52:41 - INFO - Saved maps.json
16:52:41 - INFO - Warm interactions: 54,515, Cold interactions: 13,286
16:52:42 - INFO - Saved 43,612 interactions to train.txt
16:52:42 - INFO - Saved 5,451 interactions to val.txt
16:52:42 - INFO - Saved 5,452 interactions to test_warm.txt
16:52:42 - INFO - Saved 13,286 interactions to test_cold.txt
16:52:42 - INFO - ✓ Verified: max train item (4955) < n_warm (4956)
16:52:42 - INFO - Loading metadata for 6,194 items from data\raw\meta_Beauty_and_Personal_Care.jsonl.gz
16:52:42 - INFO - Using uncompressed metadata: data\raw\meta_Beauty_and_Personal_Care.jsonl
16:52:43 - INFO - Processed 100,000 lines, found 1,970 items...
16:52:44 - INFO - Processed 200,000 lines, found 3,006 items...
16:52:45 - INFO - Processed 300,000 lines, found 3,772 items...
16:52:46 - INFO - Processed 400,000 lines, found 4,313 items...
16:52:47 - INFO - Processed 500,000 lines, found 4,805 items...
16:52:48 - INFO - Processed 600,000 lines, found 5,226 items...
16:52:49 - INFO - Processed 700,000 lines, found 5,582 items...
16:52:50 - INFO - Processed 800,000 lines, found 5,915 items...
16:52:51 - INFO - Processed 900,000 lines, found 6,191 items...
16:52:52 - INFO - Loaded metadata for 6,194/6,194 items
16:52:54 - INFO - Extracting features on device: cuda
16:52:54 - INFO - Loading SBERT model: sentence-transformers/all-mpnet-base-v2
16:52:54 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
16:52:59 - INFO - Encoding 6,194 texts with SBERT (batch_size=128)...
16:53:29 - INFO - Saved text features: (6194, 768)
16:53:29 - INFO - Loading CLIP model: openai/clip-vit-large-patch14
16:53:33 - INFO - Extracting visual features for 6,194 items...
16:53:33 - INFO -   Batch size: 128, Download workers: 14
16:54:27 - INFO - Progress: 640/6194 (640 ok, 0 fail) | 11.9 items/s | ETA: 465s
16:55:14 - INFO - Progress: 1280/6194 (1280 ok, 0 fail) | 12.7 items/s | ETA: 387s
16:56:01 - INFO - Progress: 1920/6194 (1920 ok, 0 fail) | 13.0 items/s | ETA: 329s
16:56:47 - INFO - Progress: 2560/6194 (2559 ok, 1 fail) | 13.2 items/s | ETA: 274s
16:57:35 - INFO - Progress: 3200/6194 (3199 ok, 1 fail) | 13.2 items/s | ETA: 226s
16:58:24 - INFO - Progress: 3840/6194 (3838 ok, 2 fail) | 13.2 items/s | ETA: 178s
16:59:14 - INFO - Progress: 4480/6194 (4478 ok, 2 fail) | 13.2 items/s | ETA: 130s
16:59:59 - INFO - Progress: 5120/6194 (5118 ok, 2 fail) | 13.3 items/s | ETA: 81s
17:00:51 - INFO - Progress: 5760/6194 (5757 ok, 3 fail) | 13.2 items/s | ETA: 33s
17:01:20 - INFO - Progress: 6194/6194 (6191 ok, 3 fail) | 13.3 items/s | ETA: 0s
17:01:20 - INFO - Visual extraction complete: 6,191 successful, 3 failed in 466.5s (13.3 items/s)
17:01:20 - INFO - Saved visual features: (6194, 768)
17:01:20 - INFO - Saved statistics to stat.txt
17:01:20 - INFO - ============================================================
17:01:20 - INFO - Preprocessing Complete!
17:01:20 - INFO - Output directory: data\processed\beauty
17:01:20 - INFO - ============================================================
17:01:20 - INFO - Log copied to: data\processed\beauty\preprocessing.log
17:01:20 - INFO - ======================================================================
17:01:20 - INFO - PREPROCESSING COMPLETE
17:01:20 - INFO - ======================================================================
