19:34:38 - INFO - ======================================================================
19:34:38 - INFO - RUN TYPE: PREPROCESSING
19:34:38 - INFO - DATASET: beauty
19:34:38 - INFO - TIMESTAMP: 20251218_193438
19:34:38 - INFO - LOG DIR: logs\preprocessing\beauty_20251218_193438
19:34:38 - INFO - ======================================================================
19:34:39 - INFO - System Information:
19:34:39 - INFO -   platform: Windows-11-10.0.26200-SP0
19:34:39 - INFO -   python_version: 3.12.8
19:34:39 - INFO -   cpu_count: 20
19:34:39 - INFO -   ram_total_gb: 63.77
19:34:39 - INFO -   ram_available_gb: 49.38
19:34:39 - INFO -   gpu_name: NVIDIA GeForce RTX 3060
19:34:39 - INFO -   gpu_memory_gb: 12.00
19:34:39 - INFO -   cuda_version: 12.8
19:34:39 - INFO - Configuration:
19:34:39 - INFO -   clip_model: openai/clip-vit-large-patch14
19:34:39 - INFO -   cold_item_ratio: 0.2
19:34:39 - INFO -   dataset: beauty
19:34:39 - INFO -   k_core: 5
19:34:39 - INFO -   max_total_nodes: 25000
19:34:39 - INFO -   min_total_nodes: 20000
19:34:39 - INFO -   sbert_model: sentence-transformers/all-mpnet-base-v2
19:34:39 - INFO -   seed: 42
19:34:39 - INFO -   seed_users: 10000
19:34:39 - INFO -   test_warm_ratio: 0.1
19:34:39 - INFO -   text_columns: ['title', 'description', 'features']
19:34:39 - INFO -   train_ratio: 0.8
19:34:39 - INFO -   val_ratio: 0.1
19:34:39 - INFO - 
19:34:39 - INFO - Output directory: data\processed\beauty
19:34:39 - INFO - 
19:34:39 - INFO - ============================================================
19:34:39 - INFO - Starting Inductive Preprocessing Pipeline
19:34:39 - INFO - ============================================================
19:34:39 - INFO - Loading interactions from data\raw\Beauty_and_Personal_Care.csv
19:34:42 - INFO - Loaded 6,624,441 interactions, 729,576 users, 207,649 items
19:34:43 - INFO - Memory usage: 884.5 MB
19:34:43 - INFO - Attempt 1: Sampling 10,000 seed users...
19:34:43 - INFO - Applying recursive 5-core filtering...
19:34:43 - INFO - K-core converged after 6 iterations
19:34:43 - INFO - K-core: 90,997 → 0 interactions (0.0%)
19:34:43 - INFO - Result: 0 users + 0 items = 0 total nodes
19:34:43 - WARNING - Graph too small (0 < 20000). Increasing seed: 10,000 → 12,000
19:34:43 - INFO - Attempt 2: Sampling 12,000 seed users...
19:34:44 - INFO - Applying recursive 5-core filtering...
19:34:44 - INFO - K-core converged after 7 iterations
19:34:44 - INFO - K-core: 106,999 → 0 interactions (0.0%)
19:34:44 - INFO - Result: 0 users + 0 items = 0 total nodes
19:34:44 - WARNING - Graph too small (0 < 20000). Increasing seed: 12,000 → 14,400
19:34:44 - INFO - Attempt 3: Sampling 14,400 seed users...
19:34:44 - INFO - Applying recursive 5-core filtering...
19:34:44 - INFO - K-core converged after 9 iterations
19:34:44 - INFO - K-core: 132,512 → 0 interactions (0.0%)
19:34:44 - INFO - Result: 0 users + 0 items = 0 total nodes
19:34:44 - WARNING - Graph too small (0 < 20000). Increasing seed: 14,400 → 17,280
19:34:44 - INFO - Attempt 4: Sampling 17,280 seed users...
19:34:45 - INFO - Applying recursive 5-core filtering...
19:34:45 - INFO - K-core converged after 14 iterations
19:34:45 - INFO - K-core: 157,180 → 0 interactions (0.0%)
19:34:45 - INFO - Result: 0 users + 0 items = 0 total nodes
19:34:45 - WARNING - Graph too small (0 < 20000). Increasing seed: 17,280 → 20,736
19:34:45 - INFO - Attempt 5: Sampling 20,736 seed users...
19:34:45 - INFO - Applying recursive 5-core filtering...
19:34:46 - INFO - K-core converged after 35 iterations
19:34:46 - INFO - K-core: 187,209 → 4,363 interactions (2.3%)
19:34:46 - INFO - Result: 642 users + 514 items = 1,156 total nodes
19:34:46 - WARNING - Graph too small (1156 < 20000). Increasing seed: 20,736 → 24,883
19:34:46 - INFO - Attempt 6: Sampling 24,883 seed users...
19:34:46 - INFO - Applying recursive 5-core filtering...
19:34:46 - INFO - K-core converged after 21 iterations
19:34:46 - INFO - K-core: 225,610 → 21,528 interactions (9.5%)
19:34:46 - INFO - Result: 3,014 users + 2,224 items = 5,238 total nodes
19:34:46 - WARNING - Graph too small (5238 < 20000). Increasing seed: 24,883 → 29,859
19:34:46 - INFO - Attempt 7: Sampling 29,859 seed users...
19:34:47 - INFO - Applying recursive 5-core filtering...
19:34:47 - INFO - K-core converged after 13 iterations
19:34:47 - INFO - K-core: 273,413 → 40,724 interactions (14.9%)
19:34:47 - INFO - Result: 5,422 users + 3,876 items = 9,298 total nodes
19:34:47 - WARNING - Graph too small (9298 < 20000). Increasing seed: 29,859 → 35,830
19:34:47 - INFO - Attempt 8: Sampling 35,830 seed users...
19:34:48 - INFO - Applying recursive 5-core filtering...
19:34:48 - INFO - K-core converged after 11 iterations
19:34:48 - INFO - K-core: 331,409 → 67,801 interactions (20.5%)
19:34:48 - INFO - Result: 8,840 users + 6,194 items = 15,034 total nodes
19:34:48 - WARNING - Graph too small (15034 < 20000). Increasing seed: 35,830 → 42,996
19:34:48 - INFO - Attempt 9: Sampling 42,996 seed users...
19:34:49 - INFO - Applying recursive 5-core filtering...
19:34:49 - INFO - K-core converged after 10 iterations
19:34:49 - INFO - K-core: 391,902 → 102,937 interactions (26.3%)
19:34:49 - INFO - Result: 13,367 users + 8,790 items = 22,157 total nodes
19:34:49 - INFO - ✓ Graph size 22,157 within target range [20000, 25000]
19:34:49 - INFO - Item split: 7,032 warm (80%), 1,758 cold (20%)
19:34:49 - INFO - Created ID mappings: 13,367 users, 7,032 warm items, 1,758 cold items
19:34:49 - INFO - Saved maps.json
19:34:49 - INFO - Warm interactions: 82,871, Cold interactions: 20,066
19:34:50 - INFO - Saved 66,296 interactions to train.txt
19:34:50 - INFO - Saved 8,287 interactions to val.txt
19:34:50 - INFO - Saved 8,288 interactions to test_warm.txt
19:34:51 - INFO - Saved 20,066 interactions to test_cold.txt
19:34:51 - INFO - ✓ Verified: max train item (7031) < n_warm (7032)
19:34:51 - INFO - Loading metadata for 8,790 items from data\raw\meta_Beauty_and_Personal_Care.jsonl.gz
19:34:51 - INFO - Using uncompressed metadata: data\raw\meta_Beauty_and_Personal_Care.jsonl
19:34:52 - INFO - Processed 100,000 lines, found 2,636 items...
19:34:53 - INFO - Processed 200,000 lines, found 4,070 items...
19:34:54 - INFO - Processed 300,000 lines, found 5,147 items...
19:34:55 - INFO - Processed 400,000 lines, found 6,037 items...
19:34:55 - INFO - Processed 500,000 lines, found 6,754 items...
19:34:56 - INFO - Processed 600,000 lines, found 7,364 items...
19:34:57 - INFO - Processed 700,000 lines, found 7,893 items...
19:34:58 - INFO - Processed 800,000 lines, found 8,371 items...
19:34:59 - INFO - Processed 900,000 lines, found 8,786 items...
19:35:00 - INFO - Loaded metadata for 8,790/8,790 items
19:35:02 - INFO - Extracting features on device: cuda
19:35:03 - INFO - Loading SBERT model: sentence-transformers/all-mpnet-base-v2
19:35:03 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
19:35:07 - INFO - Encoding 8,790 texts with SBERT (batch_size=256)...
19:35:58 - INFO - Saved text features: (8790, 768)
19:35:58 - INFO - Loading CLIP model: openai/clip-vit-large-patch14
19:36:04 - INFO - Extracting visual features for 8,790 items...
19:36:04 - INFO -   Batch size: 256, Download workers: 14
19:37:39 - INFO - Progress: 1280/8790 (1280 ok, 0 fail) | 13.5 items/s | ETA: 557s
19:39:09 - INFO - Progress: 2560/8790 (2558 ok, 2 fail) | 13.8 items/s | ETA: 451s
19:40:45 - INFO - Progress: 3840/8790 (3838 ok, 2 fail) | 13.6 items/s | ETA: 363s
19:42:20 - INFO - Progress: 5120/8790 (5116 ok, 4 fail) | 13.6 items/s | ETA: 270s
19:43:54 - INFO - Progress: 6400/8790 (6396 ok, 4 fail) | 13.6 items/s | ETA: 176s
19:45:30 - INFO - Progress: 7680/8790 (7676 ok, 4 fail) | 13.6 items/s | ETA: 82s
19:46:51 - INFO - Progress: 8790/8790 (8785 ok, 5 fail) | 13.6 items/s | ETA: 0s
19:46:51 - INFO - Visual extraction complete: 8,785 successful, 5 failed in 647.6s (13.6 items/s)
19:46:51 - INFO - Saved visual features: (8790, 768)
19:46:51 - INFO - Saved statistics to stat.txt
19:46:51 - INFO - ============================================================
19:46:51 - INFO - Preprocessing Complete!
19:46:51 - INFO - Output directory: data\processed\beauty
19:46:51 - INFO - ============================================================
19:46:51 - INFO - Log copied to: data\processed\beauty\preprocessing.log
19:46:51 - INFO - ======================================================================
19:46:51 - INFO - PREPROCESSING COMPLETE
19:46:51 - INFO - ======================================================================
