19:46:57 - INFO - ======================================================================
19:46:57 - INFO - RUN TYPE: PREPROCESSING
19:46:57 - INFO - DATASET: clothing
19:46:57 - INFO - TIMESTAMP: 20251218_194657
19:46:57 - INFO - LOG DIR: logs\preprocessing\clothing_20251218_194657
19:46:57 - INFO - ======================================================================
19:46:57 - INFO - System Information:
19:46:57 - INFO -   platform: Windows-11-10.0.26200-SP0
19:46:57 - INFO -   python_version: 3.12.8
19:46:57 - INFO -   cpu_count: 20
19:46:57 - INFO -   ram_total_gb: 63.77
19:46:57 - INFO -   ram_available_gb: 49.36
19:46:57 - INFO -   gpu_name: NVIDIA GeForce RTX 3060
19:46:57 - INFO -   gpu_memory_gb: 12.00
19:46:57 - INFO -   cuda_version: 12.8
19:46:57 - INFO - Configuration:
19:46:57 - INFO -   clip_model: openai/clip-vit-large-patch14
19:46:57 - INFO -   cold_item_ratio: 0.2
19:46:57 - INFO -   dataset: clothing
19:46:57 - INFO -   k_core: 5
19:46:57 - INFO -   max_total_nodes: 25000
19:46:57 - INFO -   min_total_nodes: 20000
19:46:57 - INFO -   sbert_model: sentence-transformers/all-mpnet-base-v2
19:46:57 - INFO -   seed: 42
19:46:57 - INFO -   seed_users: 10000
19:46:57 - INFO -   test_warm_ratio: 0.1
19:46:57 - INFO -   text_columns: ['title', 'description', 'features']
19:46:57 - INFO -   train_ratio: 0.8
19:46:57 - INFO -   val_ratio: 0.1
19:46:57 - INFO - 
19:46:57 - INFO - Output directory: data\processed\clothing
19:46:57 - INFO - 
19:46:57 - INFO - ============================================================
19:46:57 - INFO - Starting Inductive Preprocessing Pipeline
19:46:57 - INFO - ============================================================
19:46:57 - INFO - Loading interactions from data\raw\Clothing_Shoes_and_Jewelry.csv
19:47:11 - INFO - Loaded 23,102,537 interactions, 2,524,981 users, 714,957 items
19:47:14 - INFO - Memory usage: 3084.5 MB
19:47:14 - INFO - Attempt 1: Sampling 10,000 seed users...
19:47:16 - INFO - Applying recursive 5-core filtering...
19:47:17 - INFO - K-core converged after 4 iterations
19:47:17 - INFO - K-core: 91,646 → 0 interactions (0.0%)
19:47:17 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:17 - WARNING - Graph too small (0 < 20000). Increasing seed: 10,000 → 12,000
19:47:17 - INFO - Attempt 2: Sampling 12,000 seed users...
19:47:19 - INFO - Applying recursive 5-core filtering...
19:47:19 - INFO - K-core converged after 4 iterations
19:47:19 - INFO - K-core: 109,546 → 0 interactions (0.0%)
19:47:19 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:19 - WARNING - Graph too small (0 < 20000). Increasing seed: 12,000 → 14,400
19:47:19 - INFO - Attempt 3: Sampling 14,400 seed users...
19:47:21 - INFO - Applying recursive 5-core filtering...
19:47:21 - INFO - K-core converged after 4 iterations
19:47:21 - INFO - K-core: 131,376 → 0 interactions (0.0%)
19:47:21 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:21 - WARNING - Graph too small (0 < 20000). Increasing seed: 14,400 → 17,280
19:47:21 - INFO - Attempt 4: Sampling 17,280 seed users...
19:47:23 - INFO - Applying recursive 5-core filtering...
19:47:23 - INFO - K-core converged after 5 iterations
19:47:23 - INFO - K-core: 158,460 → 0 interactions (0.0%)
19:47:23 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:23 - WARNING - Graph too small (0 < 20000). Increasing seed: 17,280 → 20,736
19:47:23 - INFO - Attempt 5: Sampling 20,736 seed users...
19:47:26 - INFO - Applying recursive 5-core filtering...
19:47:26 - INFO - K-core converged after 5 iterations
19:47:26 - INFO - K-core: 189,558 → 0 interactions (0.0%)
19:47:26 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:26 - WARNING - Graph too small (0 < 20000). Increasing seed: 20,736 → 24,883
19:47:26 - INFO - Attempt 6: Sampling 24,883 seed users...
19:47:28 - INFO - Applying recursive 5-core filtering...
19:47:28 - INFO - K-core converged after 6 iterations
19:47:28 - INFO - K-core: 227,581 → 0 interactions (0.0%)
19:47:28 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:28 - WARNING - Graph too small (0 < 20000). Increasing seed: 24,883 → 29,859
19:47:28 - INFO - Attempt 7: Sampling 29,859 seed users...
19:47:30 - INFO - Applying recursive 5-core filtering...
19:47:31 - INFO - K-core converged after 7 iterations
19:47:31 - INFO - K-core: 271,449 → 0 interactions (0.0%)
19:47:31 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:31 - WARNING - Graph too small (0 < 20000). Increasing seed: 29,859 → 35,830
19:47:31 - INFO - Attempt 8: Sampling 35,830 seed users...
19:47:33 - INFO - Applying recursive 5-core filtering...
19:47:33 - INFO - K-core converged after 8 iterations
19:47:33 - INFO - K-core: 327,028 → 0 interactions (0.0%)
19:47:33 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:33 - WARNING - Graph too small (0 < 20000). Increasing seed: 35,830 → 42,996
19:47:33 - INFO - Attempt 9: Sampling 42,996 seed users...
19:47:35 - INFO - Applying recursive 5-core filtering...
19:47:36 - INFO - K-core converged after 13 iterations
19:47:36 - INFO - K-core: 393,955 → 0 interactions (0.0%)
19:47:36 - INFO - Result: 0 users + 0 items = 0 total nodes
19:47:36 - WARNING - Graph too small (0 < 20000). Increasing seed: 42,996 → 51,595
19:47:36 - INFO - Attempt 10: Sampling 51,595 seed users...
19:47:38 - INFO - Applying recursive 5-core filtering...
19:47:38 - INFO - K-core converged after 73 iterations
19:47:38 - INFO - K-core: 469,360 → 17,034 interactions (3.6%)
19:47:39 - INFO - Result: 2,596 users + 1,982 items = 4,578 total nodes
19:47:39 - WARNING - Graph too small (4578 < 20000). Increasing seed: 51,595 → 61,914
19:47:39 - INFO - Attempt 11: Sampling 61,914 seed users...
19:47:41 - INFO - Applying recursive 5-core filtering...
19:47:41 - INFO - K-core converged after 20 iterations
19:47:41 - INFO - K-core: 567,328 → 64,541 interactions (11.4%)
19:47:42 - INFO - Result: 8,988 users + 6,526 items = 15,514 total nodes
19:47:42 - WARNING - Graph too small (15514 < 20000). Increasing seed: 61,914 → 74,296
19:47:42 - INFO - Attempt 12: Sampling 74,296 seed users...
19:47:44 - INFO - Applying recursive 5-core filtering...
19:47:45 - INFO - K-core converged after 14 iterations
19:47:45 - INFO - K-core: 677,516 → 109,285 interactions (16.1%)
19:47:45 - INFO - Result: 14,983 users + 10,275 items = 25,258 total nodes
19:47:45 - WARNING - Graph too large (25258 > 25000). Decreasing seed: 74,296 → 59,436
19:47:45 - INFO - Attempt 13: Sampling 59,436 seed users...
19:47:47 - INFO - Applying recursive 5-core filtering...
19:47:48 - INFO - K-core converged after 16 iterations
19:47:48 - INFO - K-core: 546,165 → 54,919 interactions (10.1%)
19:47:48 - INFO - Result: 7,814 users + 5,676 items = 13,490 total nodes
19:47:48 - WARNING - Graph too small (13490 < 20000). Increasing seed: 59,436 → 71,323
19:47:48 - INFO - Attempt 14: Sampling 71,323 seed users...
19:47:50 - INFO - Applying recursive 5-core filtering...
19:47:51 - INFO - K-core converged after 13 iterations
19:47:51 - INFO - K-core: 648,656 → 96,884 interactions (14.9%)
19:47:51 - INFO - Result: 13,410 users + 9,255 items = 22,665 total nodes
19:47:51 - INFO - ✓ Graph size 22,665 within target range [20000, 25000]
19:47:51 - INFO - Item split: 7,404 warm (80%), 1,851 cold (20%)
19:47:51 - INFO - Created ID mappings: 13,410 users, 7,404 warm items, 1,851 cold items
19:47:51 - INFO - Saved maps.json
19:47:51 - INFO - Warm interactions: 75,917, Cold interactions: 20,967
19:47:52 - INFO - Saved 60,733 interactions to train.txt
19:47:52 - INFO - Saved 7,592 interactions to val.txt
19:47:52 - INFO - Saved 7,592 interactions to test_warm.txt
19:47:53 - INFO - Saved 20,967 interactions to test_cold.txt
19:47:53 - INFO - ✓ Verified: max train item (7403) < n_warm (7404)
19:47:53 - INFO - Loading metadata for 9,255 items from data\raw\meta_Clothing_Shoes_and_Jewelry.jsonl.gz
19:47:53 - INFO - Using uncompressed metadata: data\raw\meta_Clothing_Shoes_and_Jewelry.jsonl
19:47:54 - INFO - Processed 100,000 lines, found 4,149 items...
19:47:55 - INFO - Processed 200,000 lines, found 5,915 items...
19:47:55 - INFO - Processed 300,000 lines, found 6,825 items...
19:47:56 - INFO - Processed 400,000 lines, found 7,338 items...
19:47:57 - INFO - Processed 500,000 lines, found 7,703 items...
19:47:58 - INFO - Processed 600,000 lines, found 7,946 items...
19:47:59 - INFO - Processed 700,000 lines, found 8,135 items...
19:48:00 - INFO - Processed 800,000 lines, found 8,290 items...
19:48:01 - INFO - Processed 900,000 lines, found 8,403 items...
19:48:02 - INFO - Processed 1,000,000 lines, found 8,489 items...
19:48:03 - INFO - Processed 1,100,000 lines, found 8,565 items...
19:48:03 - INFO - Processed 1,200,000 lines, found 8,623 items...
19:48:04 - INFO - Processed 1,300,000 lines, found 8,692 items...
19:48:05 - INFO - Processed 1,400,000 lines, found 8,746 items...
19:48:06 - INFO - Processed 1,500,000 lines, found 8,779 items...
19:48:07 - INFO - Processed 1,600,000 lines, found 8,809 items...
19:48:08 - INFO - Processed 1,700,000 lines, found 8,837 items...
19:48:09 - INFO - Processed 1,800,000 lines, found 8,858 items...
19:48:09 - INFO - Processed 1,900,000 lines, found 8,880 items...
19:48:10 - INFO - Processed 2,000,000 lines, found 8,901 items...
19:48:11 - INFO - Processed 2,100,000 lines, found 8,920 items...
19:48:12 - INFO - Processed 2,200,000 lines, found 8,934 items...
19:48:13 - INFO - Processed 2,300,000 lines, found 8,946 items...
19:48:14 - INFO - Processed 2,400,000 lines, found 8,964 items...
19:48:15 - INFO - Processed 2,500,000 lines, found 8,980 items...
19:48:16 - INFO - Processed 2,600,000 lines, found 8,998 items...
19:48:16 - INFO - Processed 2,700,000 lines, found 9,011 items...
19:48:17 - INFO - Processed 2,800,000 lines, found 9,023 items...
19:48:22 - INFO - Processed 2,900,000 lines, found 9,035 items...
19:48:23 - INFO - Processed 3,000,000 lines, found 9,047 items...
19:48:24 - INFO - Processed 3,100,000 lines, found 9,052 items...
19:48:25 - INFO - Processed 3,200,000 lines, found 9,062 items...
19:48:26 - INFO - Processed 3,300,000 lines, found 9,110 items...
19:48:27 - INFO - Processed 3,400,000 lines, found 9,132 items...
19:48:28 - INFO - Processed 3,500,000 lines, found 9,136 items...
19:48:28 - INFO - Processed 3,600,000 lines, found 9,145 items...
19:48:29 - INFO - Processed 3,700,000 lines, found 9,156 items...
19:48:30 - INFO - Processed 3,800,000 lines, found 9,166 items...
19:48:31 - INFO - Processed 3,900,000 lines, found 9,171 items...
19:48:32 - INFO - Processed 4,000,000 lines, found 9,178 items...
19:48:33 - INFO - Processed 4,100,000 lines, found 9,179 items...
19:48:34 - INFO - Processed 4,200,000 lines, found 9,184 items...
19:48:35 - INFO - Processed 4,300,000 lines, found 9,188 items...
19:48:36 - INFO - Processed 4,400,000 lines, found 9,192 items...
19:48:36 - INFO - Processed 4,500,000 lines, found 9,199 items...
19:48:37 - INFO - Processed 4,600,000 lines, found 9,204 items...
19:48:38 - INFO - Processed 4,700,000 lines, found 9,207 items...
19:48:39 - INFO - Processed 4,800,000 lines, found 9,211 items...
19:48:40 - INFO - Processed 4,900,000 lines, found 9,214 items...
19:48:41 - INFO - Processed 5,000,000 lines, found 9,221 items...
19:48:42 - INFO - Processed 5,100,000 lines, found 9,226 items...
19:48:43 - INFO - Processed 5,200,000 lines, found 9,231 items...
19:48:43 - INFO - Processed 5,300,000 lines, found 9,239 items...
19:48:44 - INFO - Processed 5,400,000 lines, found 9,240 items...
19:48:45 - INFO - Processed 5,500,000 lines, found 9,245 items...
19:48:46 - INFO - Processed 5,600,000 lines, found 9,250 items...
19:48:47 - INFO - Processed 5,700,000 lines, found 9,254 items...
19:48:48 - INFO - Processed 5,800,000 lines, found 9,254 items...
19:48:48 - INFO - Processed 5,900,000 lines, found 9,254 items...
19:48:49 - INFO - Processed 6,000,000 lines, found 9,254 items...
19:48:50 - INFO - Processed 6,100,000 lines, found 9,254 items...
19:48:50 - INFO - Loaded metadata for 9,255/9,255 items
19:48:53 - INFO - Extracting features on device: cuda
19:48:53 - INFO - Loading SBERT model: sentence-transformers/all-mpnet-base-v2
19:48:53 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
19:48:57 - INFO - Encoding 9,255 texts with SBERT (batch_size=256)...
19:50:08 - INFO - Saved text features: (9255, 768)
19:50:08 - INFO - Loading CLIP model: openai/clip-vit-large-patch14
19:50:12 - INFO - Extracting visual features for 9,255 items...
19:50:12 - INFO -   Batch size: 256, Download workers: 14
19:51:48 - INFO - Progress: 1280/9255 (1280 ok, 0 fail) | 13.4 items/s | ETA: 595s
19:53:19 - INFO - Progress: 2560/9255 (2560 ok, 0 fail) | 13.7 items/s | ETA: 489s
19:54:51 - INFO - Progress: 3840/9255 (3840 ok, 0 fail) | 13.8 items/s | ETA: 393s
19:56:27 - INFO - Progress: 5120/9255 (5119 ok, 1 fail) | 13.7 items/s | ETA: 302s
19:58:00 - INFO - Progress: 6400/9255 (6399 ok, 1 fail) | 13.7 items/s | ETA: 209s
19:59:36 - INFO - Progress: 7680/9255 (7677 ok, 3 fail) | 13.6 items/s | ETA: 116s
20:01:12 - INFO - Progress: 8960/9255 (8956 ok, 4 fail) | 13.6 items/s | ETA: 22s
20:01:35 - INFO - Progress: 9255/9255 (9251 ok, 4 fail) | 13.5 items/s | ETA: 0s
20:01:35 - INFO - Visual extraction complete: 9,251 successful, 4 failed in 683.1s (13.5 items/s)
20:01:35 - INFO - Saved visual features: (9255, 768)
20:01:35 - INFO - Saved statistics to stat.txt
20:01:35 - INFO - ============================================================
20:01:35 - INFO - Preprocessing Complete!
20:01:35 - INFO - Output directory: data\processed\clothing
20:01:35 - INFO - ============================================================
20:01:35 - INFO - Log copied to: data\processed\clothing\preprocessing.log
20:01:35 - INFO - ======================================================================
20:01:35 - INFO - PREPROCESSING COMPLETE
20:01:35 - INFO - ======================================================================
