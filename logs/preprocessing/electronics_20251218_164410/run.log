16:44:10 - INFO - ======================================================================
16:44:10 - INFO - RUN TYPE: PREPROCESSING
16:44:10 - INFO - DATASET: electronics
16:44:10 - INFO - TIMESTAMP: 20251218_164410
16:44:10 - INFO - LOG DIR: logs\preprocessing\electronics_20251218_164410
16:44:10 - INFO - ======================================================================
16:44:10 - INFO - System Information:
16:44:10 - INFO -   platform: Windows-11-10.0.26200-SP0
16:44:10 - INFO -   python_version: 3.12.8
16:44:10 - INFO -   cpu_count: 20
16:44:10 - INFO -   ram_total_gb: 63.77
16:44:10 - INFO -   ram_available_gb: 49.56
16:44:10 - INFO -   gpu_name: NVIDIA GeForce RTX 3060
16:44:10 - INFO -   gpu_memory_gb: 12.00
16:44:10 - INFO -   cuda_version: 12.8
16:44:10 - INFO - Configuration:
16:44:10 - INFO -   clip_model: openai/clip-vit-large-patch14
16:44:10 - INFO -   cold_item_ratio: 0.2
16:44:10 - INFO -   dataset: electronics
16:44:10 - INFO -   k_core: 5
16:44:10 - INFO -   max_total_nodes: 20000
16:44:10 - INFO -   min_total_nodes: 12500
16:44:10 - INFO -   sbert_model: sentence-transformers/all-mpnet-base-v2
16:44:10 - INFO -   seed: 42
16:44:10 - INFO -   seed_users: 10000
16:44:10 - INFO -   test_warm_ratio: 0.1
16:44:10 - INFO -   text_columns: ['title', 'description', 'features']
16:44:10 - INFO -   train_ratio: 0.8
16:44:10 - INFO -   val_ratio: 0.1
16:44:10 - INFO - 
16:44:10 - INFO - Output directory: data\processed\electronics
16:44:10 - INFO - 
16:44:10 - INFO - ============================================================
16:44:10 - INFO - Starting Inductive Preprocessing Pipeline
16:44:10 - INFO - ============================================================
16:44:10 - INFO - Loading interactions from data\raw\Electronics.csv
16:44:18 - INFO - Loaded 15,473,536 interactions, 1,641,026 users, 368,228 items
16:44:20 - INFO - Memory usage: 2066.0 MB
16:44:21 - INFO - Attempt 1: Sampling 10,000 seed users...
16:44:22 - INFO - Applying recursive 5-core filtering...
16:44:22 - INFO - K-core converged after 7 iterations
16:44:22 - INFO - K-core: 93,740 → 0 interactions (0.0%)
16:44:22 - INFO - Result: 0 users + 0 items = 0 total nodes
16:44:22 - WARNING - Graph too small (0 < 12500). Increasing seed: 10,000 → 12,000
16:44:22 - INFO - Attempt 2: Sampling 12,000 seed users...
16:44:24 - INFO - Applying recursive 5-core filtering...
16:44:24 - INFO - K-core converged after 10 iterations
16:44:24 - INFO - K-core: 113,528 → 0 interactions (0.0%)
16:44:24 - INFO - Result: 0 users + 0 items = 0 total nodes
16:44:24 - WARNING - Graph too small (0 < 12500). Increasing seed: 12,000 → 14,400
16:44:24 - INFO - Attempt 3: Sampling 14,400 seed users...
16:44:25 - INFO - Applying recursive 5-core filtering...
16:44:25 - INFO - K-core converged after 14 iterations
16:44:25 - INFO - K-core: 134,485 → 0 interactions (0.0%)
16:44:25 - INFO - Result: 0 users + 0 items = 0 total nodes
16:44:25 - WARNING - Graph too small (0 < 12500). Increasing seed: 14,400 → 17,280
16:44:25 - INFO - Attempt 4: Sampling 17,280 seed users...
16:44:27 - INFO - Applying recursive 5-core filtering...
16:44:27 - INFO - K-core converged after 20 iterations
16:44:27 - INFO - K-core: 162,844 → 7,035 interactions (4.3%)
16:44:27 - INFO - Result: 1,010 users + 743 items = 1,753 total nodes
16:44:27 - WARNING - Graph too small (1753 < 12500). Increasing seed: 17,280 → 20,736
16:44:27 - INFO - Attempt 5: Sampling 20,736 seed users...
16:44:28 - INFO - Applying recursive 5-core filtering...
16:44:28 - INFO - K-core converged after 12 iterations
16:44:28 - INFO - K-core: 196,276 → 16,385 interactions (8.3%)
16:44:28 - INFO - Result: 2,214 users + 1,614 items = 3,828 total nodes
16:44:28 - WARNING - Graph too small (3828 < 12500). Increasing seed: 20,736 → 24,883
16:44:28 - INFO - Attempt 6: Sampling 24,883 seed users...
16:44:30 - INFO - Applying recursive 5-core filtering...
16:44:30 - INFO - K-core converged after 14 iterations
16:44:30 - INFO - K-core: 235,344 → 29,054 interactions (12.3%)
16:44:30 - INFO - Result: 3,903 users + 2,659 items = 6,562 total nodes
16:44:30 - WARNING - Graph too small (6562 < 12500). Increasing seed: 24,883 → 29,859
16:44:30 - INFO - Attempt 7: Sampling 29,859 seed users...
16:44:32 - INFO - Applying recursive 5-core filtering...
16:44:32 - INFO - K-core converged after 12 iterations
16:44:32 - INFO - K-core: 281,399 → 44,523 interactions (15.8%)
16:44:32 - INFO - Result: 5,762 users + 3,935 items = 9,697 total nodes
16:44:32 - WARNING - Graph too small (9697 < 12500). Increasing seed: 29,859 → 35,830
16:44:32 - INFO - Attempt 8: Sampling 35,830 seed users...
16:44:34 - INFO - Applying recursive 5-core filtering...
16:44:34 - INFO - K-core converged after 9 iterations
16:44:34 - INFO - K-core: 336,356 → 67,276 interactions (20.0%)
16:44:34 - INFO - Result: 8,583 users + 5,627 items = 14,210 total nodes
16:44:34 - INFO - ✓ Graph size 14,210 within target range [12500, 20000]
16:44:34 - INFO - Item split: 4,502 warm (80%), 1,125 cold (20%)
16:44:34 - INFO - Created ID mappings: 8,583 users, 4,502 warm items, 1,125 cold items
16:44:34 - INFO - Saved maps.json
16:44:34 - INFO - Warm interactions: 53,651, Cold interactions: 13,625
16:44:35 - INFO - Saved 42,920 interactions to train.txt
16:44:35 - INFO - Saved 5,365 interactions to val.txt
16:44:35 - INFO - Saved 5,366 interactions to test_warm.txt
16:44:35 - INFO - Saved 13,625 interactions to test_cold.txt
16:44:35 - INFO - ✓ Verified: max train item (4501) < n_warm (4502)
16:44:35 - INFO - Loading metadata for 5,627 items from data\raw\meta_Electronics.jsonl.gz
16:44:35 - INFO - Using uncompressed metadata: data\raw\meta_Electronics.jsonl
16:44:37 - INFO - Processed 100,000 lines, found 1,109 items...
16:44:38 - INFO - Processed 200,000 lines, found 1,840 items...
16:44:39 - INFO - Processed 300,000 lines, found 2,438 items...
16:44:40 - INFO - Processed 400,000 lines, found 2,910 items...
16:44:42 - INFO - Processed 500,000 lines, found 3,316 items...
16:44:43 - INFO - Processed 600,000 lines, found 3,699 items...
16:44:44 - INFO - Processed 700,000 lines, found 4,001 items...
16:44:45 - INFO - Processed 800,000 lines, found 4,265 items...
16:44:46 - INFO - Processed 900,000 lines, found 4,526 items...
16:44:47 - INFO - Processed 1,000,000 lines, found 4,774 items...
16:44:48 - INFO - Processed 1,100,000 lines, found 5,013 items...
16:44:49 - INFO - Processed 1,200,000 lines, found 5,235 items...
16:44:50 - INFO - Processed 1,300,000 lines, found 5,461 items...
16:44:52 - INFO - Processed 1,400,000 lines, found 5,626 items...
16:44:52 - INFO - Processed 1,500,000 lines, found 5,626 items...
16:44:53 - INFO - Loaded metadata for 5,627/5,627 items
16:44:56 - INFO - Extracting features on device: cuda
16:44:56 - INFO - Loading SBERT model: sentence-transformers/all-mpnet-base-v2
16:44:56 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
16:45:00 - INFO - Encoding 5,627 texts with SBERT (batch_size=128)...
16:45:41 - INFO - Saved text features: (5627, 768)
16:45:41 - INFO - Loading CLIP model: openai/clip-vit-large-patch14
16:45:45 - INFO - Extracting visual features for 5,627 items...
16:45:45 - INFO -   Batch size: 128, Download workers: 14
16:46:37 - INFO - Progress: 640/5627 (640 ok, 0 fail) | 12.4 items/s | ETA: 401s
16:47:21 - INFO - Progress: 1280/5627 (1280 ok, 0 fail) | 13.4 items/s | ETA: 325s
16:48:03 - INFO - Progress: 1920/5627 (1920 ok, 0 fail) | 14.0 items/s | ETA: 265s
16:48:46 - INFO - Progress: 2560/5627 (2560 ok, 0 fail) | 14.2 items/s | ETA: 216s
16:49:33 - INFO - Progress: 3200/5627 (3200 ok, 0 fail) | 14.1 items/s | ETA: 173s
16:50:18 - INFO - Progress: 3840/5627 (3840 ok, 0 fail) | 14.1 items/s | ETA: 127s
16:50:59 - INFO - Progress: 4480/5627 (4480 ok, 0 fail) | 14.3 items/s | ETA: 80s
16:51:47 - INFO - Progress: 5120/5627 (5120 ok, 0 fail) | 14.1 items/s | ETA: 36s
16:52:26 - INFO - Progress: 5627/5627 (5627 ok, 0 fail) | 14.1 items/s | ETA: 0s
16:52:26 - INFO - Visual extraction complete: 5,627 successful, 0 failed in 400.4s (14.1 items/s)
16:52:26 - INFO - Saved visual features: (5627, 768)
16:52:26 - INFO - Saved statistics to stat.txt
16:52:26 - INFO - ============================================================
16:52:26 - INFO - Preprocessing Complete!
16:52:26 - INFO - Output directory: data\processed\electronics
16:52:26 - INFO - ============================================================
16:52:26 - INFO - Log copied to: data\processed\electronics\preprocessing.log
16:52:26 - INFO - ======================================================================
16:52:26 - INFO - PREPROCESSING COMPLETE
16:52:26 - INFO - ======================================================================
