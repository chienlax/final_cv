19:22:51 - INFO - ======================================================================
19:22:51 - INFO - RUN TYPE: PREPROCESSING
19:22:51 - INFO - DATASET: electronics
19:22:51 - INFO - TIMESTAMP: 20251218_192251
19:22:51 - INFO - LOG DIR: logs\preprocessing\electronics_20251218_192251
19:22:51 - INFO - ======================================================================
19:22:51 - INFO - System Information:
19:22:51 - INFO -   platform: Windows-11-10.0.26200-SP0
19:22:51 - INFO -   python_version: 3.12.8
19:22:51 - INFO -   cpu_count: 20
19:22:51 - INFO -   ram_total_gb: 63.77
19:22:51 - INFO -   ram_available_gb: 49.15
19:22:51 - INFO -   gpu_name: NVIDIA GeForce RTX 3060
19:22:51 - INFO -   gpu_memory_gb: 12.00
19:22:51 - INFO -   cuda_version: 12.8
19:22:51 - INFO - Configuration:
19:22:51 - INFO -   clip_model: openai/clip-vit-large-patch14
19:22:51 - INFO -   cold_item_ratio: 0.2
19:22:51 - INFO -   dataset: electronics
19:22:51 - INFO -   k_core: 5
19:22:51 - INFO -   max_total_nodes: 25000
19:22:51 - INFO -   min_total_nodes: 20000
19:22:51 - INFO -   sbert_model: sentence-transformers/all-mpnet-base-v2
19:22:51 - INFO -   seed: 42
19:22:51 - INFO -   seed_users: 10000
19:22:51 - INFO -   test_warm_ratio: 0.1
19:22:51 - INFO -   text_columns: ['title', 'description', 'features']
19:22:51 - INFO -   train_ratio: 0.8
19:22:51 - INFO -   val_ratio: 0.1
19:22:51 - INFO - 
19:22:51 - INFO - Output directory: data\processed\electronics
19:22:51 - INFO - 
19:22:51 - INFO - ============================================================
19:22:51 - INFO - Starting Inductive Preprocessing Pipeline
19:22:51 - INFO - ============================================================
19:22:51 - INFO - Loading interactions from data\raw\Electronics.csv
19:23:00 - INFO - Loaded 15,473,536 interactions, 1,641,026 users, 368,228 items
19:23:02 - INFO - Memory usage: 2066.0 MB
19:23:02 - INFO - Attempt 1: Sampling 10,000 seed users...
19:23:04 - INFO - Applying recursive 5-core filtering...
19:23:04 - INFO - K-core converged after 7 iterations
19:23:04 - INFO - K-core: 93,740 → 0 interactions (0.0%)
19:23:04 - INFO - Result: 0 users + 0 items = 0 total nodes
19:23:04 - WARNING - Graph too small (0 < 20000). Increasing seed: 10,000 → 12,000
19:23:04 - INFO - Attempt 2: Sampling 12,000 seed users...
19:23:06 - INFO - Applying recursive 5-core filtering...
19:23:06 - INFO - K-core converged after 10 iterations
19:23:06 - INFO - K-core: 113,528 → 0 interactions (0.0%)
19:23:06 - INFO - Result: 0 users + 0 items = 0 total nodes
19:23:06 - WARNING - Graph too small (0 < 20000). Increasing seed: 12,000 → 14,400
19:23:06 - INFO - Attempt 3: Sampling 14,400 seed users...
19:23:07 - INFO - Applying recursive 5-core filtering...
19:23:07 - INFO - K-core converged after 14 iterations
19:23:07 - INFO - K-core: 134,485 → 0 interactions (0.0%)
19:23:07 - INFO - Result: 0 users + 0 items = 0 total nodes
19:23:07 - WARNING - Graph too small (0 < 20000). Increasing seed: 14,400 → 17,280
19:23:07 - INFO - Attempt 4: Sampling 17,280 seed users...
19:23:09 - INFO - Applying recursive 5-core filtering...
19:23:09 - INFO - K-core converged after 20 iterations
19:23:09 - INFO - K-core: 162,844 → 7,035 interactions (4.3%)
19:23:09 - INFO - Result: 1,010 users + 743 items = 1,753 total nodes
19:23:09 - WARNING - Graph too small (1753 < 20000). Increasing seed: 17,280 → 20,736
19:23:09 - INFO - Attempt 5: Sampling 20,736 seed users...
19:23:10 - INFO - Applying recursive 5-core filtering...
19:23:10 - INFO - K-core converged after 12 iterations
19:23:10 - INFO - K-core: 196,276 → 16,385 interactions (8.3%)
19:23:10 - INFO - Result: 2,214 users + 1,614 items = 3,828 total nodes
19:23:10 - WARNING - Graph too small (3828 < 20000). Increasing seed: 20,736 → 24,883
19:23:10 - INFO - Attempt 6: Sampling 24,883 seed users...
19:23:12 - INFO - Applying recursive 5-core filtering...
19:23:12 - INFO - K-core converged after 14 iterations
19:23:12 - INFO - K-core: 235,344 → 29,054 interactions (12.3%)
19:23:12 - INFO - Result: 3,903 users + 2,659 items = 6,562 total nodes
19:23:12 - WARNING - Graph too small (6562 < 20000). Increasing seed: 24,883 → 29,859
19:23:12 - INFO - Attempt 7: Sampling 29,859 seed users...
19:23:14 - INFO - Applying recursive 5-core filtering...
19:23:14 - INFO - K-core converged after 12 iterations
19:23:14 - INFO - K-core: 281,399 → 44,523 interactions (15.8%)
19:23:14 - INFO - Result: 5,762 users + 3,935 items = 9,697 total nodes
19:23:14 - WARNING - Graph too small (9697 < 20000). Increasing seed: 29,859 → 35,830
19:23:14 - INFO - Attempt 8: Sampling 35,830 seed users...
19:23:16 - INFO - Applying recursive 5-core filtering...
19:23:16 - INFO - K-core converged after 9 iterations
19:23:16 - INFO - K-core: 336,356 → 67,276 interactions (20.0%)
19:23:16 - INFO - Result: 8,583 users + 5,627 items = 14,210 total nodes
19:23:16 - WARNING - Graph too small (14210 < 20000). Increasing seed: 35,830 → 42,996
19:23:16 - INFO - Attempt 9: Sampling 42,996 seed users...
19:23:18 - INFO - Applying recursive 5-core filtering...
19:23:18 - INFO - K-core converged after 9 iterations
19:23:18 - INFO - K-core: 405,415 → 102,754 interactions (25.3%)
19:23:18 - INFO - Result: 12,722 users + 8,138 items = 20,860 total nodes
19:23:18 - INFO - ✓ Graph size 20,860 within target range [20000, 25000]
19:23:18 - INFO - Item split: 6,511 warm (80%), 1,627 cold (20%)
19:23:18 - INFO - Created ID mappings: 12,722 users, 6,511 warm items, 1,627 cold items
19:23:18 - INFO - Saved maps.json
19:23:18 - INFO - Warm interactions: 80,757, Cold interactions: 21,997
19:23:19 - INFO - Saved 64,605 interactions to train.txt
19:23:19 - INFO - Saved 8,076 interactions to val.txt
19:23:19 - INFO - Saved 8,076 interactions to test_warm.txt
19:23:20 - INFO - Saved 21,997 interactions to test_cold.txt
19:23:20 - INFO - ✓ Verified: max train item (6510) < n_warm (6511)
19:23:20 - INFO - Loading metadata for 8,138 items from data\raw\meta_Electronics.jsonl.gz
19:23:20 - INFO - Using uncompressed metadata: data\raw\meta_Electronics.jsonl
19:23:21 - INFO - Processed 100,000 lines, found 1,516 items...
19:23:22 - INFO - Processed 200,000 lines, found 2,539 items...
19:23:23 - INFO - Processed 300,000 lines, found 3,385 items...
19:23:25 - INFO - Processed 400,000 lines, found 4,107 items...
19:23:26 - INFO - Processed 500,000 lines, found 4,668 items...
19:23:27 - INFO - Processed 600,000 lines, found 5,227 items...
19:23:28 - INFO - Processed 700,000 lines, found 5,669 items...
19:23:29 - INFO - Processed 800,000 lines, found 6,096 items...
19:23:30 - INFO - Processed 900,000 lines, found 6,476 items...
19:23:31 - INFO - Processed 1,000,000 lines, found 6,847 items...
19:23:32 - INFO - Processed 1,100,000 lines, found 7,214 items...
19:23:34 - INFO - Processed 1,200,000 lines, found 7,540 items...
19:23:35 - INFO - Processed 1,300,000 lines, found 7,881 items...
19:23:35 - INFO - Loaded metadata for 8,138/8,138 items
19:23:38 - INFO - Extracting features on device: cuda
19:23:38 - INFO - Loading SBERT model: sentence-transformers/all-mpnet-base-v2
19:23:38 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
19:23:42 - INFO - Encoding 8,138 texts with SBERT (batch_size=256)...
19:24:47 - INFO - Saved text features: (8138, 768)
19:24:47 - INFO - Loading CLIP model: openai/clip-vit-large-patch14
19:24:51 - INFO - Extracting visual features for 8,138 items...
19:24:51 - INFO -   Batch size: 256, Download workers: 14
19:26:32 - INFO - Progress: 1280/8138 (1280 ok, 0 fail) | 12.7 items/s | ETA: 540s
19:28:03 - INFO - Progress: 2560/8138 (2560 ok, 0 fail) | 13.4 items/s | ETA: 418s
19:29:31 - INFO - Progress: 3840/8138 (3840 ok, 0 fail) | 13.7 items/s | ETA: 313s
19:30:56 - INFO - Progress: 5120/8138 (5120 ok, 0 fail) | 14.0 items/s | ETA: 215s
19:32:31 - INFO - Progress: 6400/8138 (6400 ok, 0 fail) | 13.9 items/s | ETA: 125s
19:34:03 - INFO - Progress: 7680/8138 (7680 ok, 0 fail) | 13.9 items/s | ETA: 33s
19:34:32 - INFO - Progress: 8138/8138 (8138 ok, 0 fail) | 14.0 items/s | ETA: 0s
19:34:32 - INFO - Visual extraction complete: 8,138 successful, 0 failed in 581.3s (14.0 items/s)
19:34:32 - INFO - Saved visual features: (8138, 768)
19:34:32 - INFO - Saved statistics to stat.txt
19:34:32 - INFO - ============================================================
19:34:32 - INFO - Preprocessing Complete!
19:34:32 - INFO - Output directory: data\processed\electronics
19:34:32 - INFO - ============================================================
19:34:32 - INFO - Log copied to: data\processed\electronics\preprocessing.log
19:34:32 - INFO - ======================================================================
19:34:32 - INFO - PREPROCESSING COMPLETE
19:34:32 - INFO - ======================================================================
